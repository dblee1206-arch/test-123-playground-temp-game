<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë‚´ ìºë¦­í„° í‚¤ìš°ê¸°</title>
  <style>
    body { font-family: sans-serif; text-align: center; }

    img {
      width: 150px;
      height: 150px;
      border-radius: 20px;
      object-fit: cover;
    }

    button { margin: 5px; padding: 10px; }

    /* ì•”ì „ í™”ë©´ */
    #fade {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: black;
      opacity: 0;
      pointer-events: none;
      transition: opacity 2s;
    }
  </style>
</head>
<body>

<div id="fade"></div>

<h1>ğŸ£ ë‚´ ìºë¦­í„° í‚¤ìš°ê¸°</h1>

<!-- ì‹œì‘ í™”ë©´ -->
<div id="start">
  <input type="text" id="nameInput" placeholder="ì´ë¦„ ì…ë ¥"><br><br>
  <input type="file" id="imageInput" accept="image/*"><br><br>
  <button onclick="startGame()">ì‹œì‘!</button>
</div>

<!-- ê²Œì„ í™”ë©´ -->
<div id="game" style="display:none;">
  <h2 id="petName"></h2>
  <img id="petImage"><br><br>

  â¤ï¸ ì²´ë ¥: <span id="hp">100</span><br>
  ğŸ— ë°°ê³ í””: <span id="hunger">100</span><br>
  ğŸš½ í™”ì¥ì‹¤: <span id="toilet">0</span><br><br>

  <button onclick="feed()">ë°¥ ì£¼ê¸°</button>
  <button onclick="bathroom()">í™”ì¥ì‹¤ ë³´ë‚´ê¸°</button>
</div>

<script>
let hp = 100;
let hunger = 100;
let toilet = 0;
let petName = "";
let petImage = "";
let timer;

/* ğŸ”¹ ì €ì¥ */
function saveGame() {
  localStorage.setItem("petSave", JSON.stringify({
    hp, hunger, toilet, petName, petImage
  }));
}

/* ğŸ”¹ ë¶ˆëŸ¬ì˜¤ê¸° */
function loadGame() {
  const data = localStorage.getItem("petSave");
  if (!data) return false;

  const save = JSON.parse(data);
  hp = save.hp;
  hunger = save.hunger;
  toilet = save.toilet;
  petName = save.petName;
  petImage = save.petImage;

  document.getElementById("petName").innerText = petName;
  document.getElementById("petImage").src = petImage;

  document.getElementById("start").style.display = "none";
  document.getElementById("game").style.display = "block";

  updateUI();
  timer = setInterval(updateStatus, 3000);
  return true;
}

/* ğŸ”¹ ê²Œì„ ì‹œì‘ */
function startGame() {
  const name = document.getElementById("nameInput").value;
  const file = document.getElementById("imageInput").files[0];
  if (!name || !file) {
    alert("ì´ë¦„ì´ë‘ ì‚¬ì§„ ë‘˜ ë‹¤ í•„ìš”í•´!");
    return;
  }

  petName = name;
  document.getElementById("petName").innerText = name;

  const reader = new FileReader();
  reader.onload = () => {
    petImage = reader.result;
    document.getElementById("petImage").src = petImage;
    saveGame();
  };
  reader.readAsDataURL(file);

  document.getElementById("start").style.display = "none";
  document.getElementById("game").style.display = "block";

  timer = setInterval(updateStatus, 3000);
}

/* ğŸ”¹ ìƒíƒœ ë³€í™” */
function updateStatus() {
  hunger -= 5;
  toilet += 5;

  if (hunger <= 0) {
    hunger = 0;
    hp -= 10;
  }

  updateUI();
  saveGame();

  if (hp <= 0) {
    gameOver();
  }
}

/* ğŸ”¹ ë²„íŠ¼ */
function feed() {
  hunger = Math.min(100, hunger + 20);
  updateUI();
  saveGame();
}

function bathroom() {
  toilet = 0;
  updateUI();
  saveGame();
}

/* ğŸ”¹ UI */
function updateUI() {
  document.getElementById("hp").innerText = hp;
  document.getElementById("hunger").innerText = hunger;
  document.getElementById("toilet").innerText = toilet;
}

/* ğŸ”¹ ê²Œì„ ì˜¤ë²„ + ì•”ì „ */
function gameOver() {
  clearInterval(timer);
  document.getElementById("fade").style.opacity = 1;

  setTimeout(() => {
    alert("ê²Œì„ ì˜¤ë²„â€¦ ğŸ˜¢");
    localStorage.removeItem("petSave");
    location.reload();
  }, 2000);
}

/* ğŸ”¹ í˜ì´ì§€ ì—´ë¦¬ë©´ ìë™ ë¶ˆëŸ¬ì˜¤ê¸° */
window.onload = () => {
  loadGame();
};
</script>

</body>
</html>
