<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>탈출</title>

<style>
body {
  margin: 0;
  background: black;
  color: #eaeaea;
  font-family: monospace;
  overflow: hidden;
}

#game {
  padding: 20px;
}

#text {
  min-height: 60vh;
  white-space: pre-line;
}

#inputBox {
  position: fixed;
  bottom: 0;
  width: 100%;
  padding: 10px;
  background: black;
}

input {
  width: 100%;
  padding: 10px;
  background: black;
  color: white;
  border: 1px solid #555;
  font-size: 16px;
}

/* ===== 타자 효과 커서 ===== */
.cursor::after {
  content: "▌";
  animation: blink 1s infinite;
}

@keyframes blink {
  50% { opacity: 0; }
}

/* ===== 화면 흔들림 ===== */
@keyframes shake {
  0% { transform: translate(0,0); }
  20% { transform: translate(-6px,4px); }
  40% { transform: translate(6px,-4px); }
  60% { transform: translate(-4px,6px); }
  80% { transform: translate(4px,-6px); }
  100% { transform: translate(0,0); }
}

.shake {
  animation: shake 0.5s infinite;
}

/* ===== 게임오버 영상 ===== */
#gameOverVideo {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  object-fit: cover;
  display: none;
  z-index: 999;
}
</style>
</head>

<body>

<div id="game">
  <div id="text"></div>
</div>

<div id="inputBox">
  <input id="command" placeholder="행동을 입력하세요">
</div>

<video id="gameOverVideo" muted playsinline>
  <source src="gameover.mp4" type="video/mp4">
</video>

<script>
const textBox = document.getElementById("text");
const input = document.getElementById("command");
const video = document.getElementById("gameOverVideo");

let typing = false;

/* ===== 타자 출력 ===== */
function typeText(text, callback) {
  typing = true;
  let i = 0;
  const line = document.createElement("div");
  line.classList.add("cursor");
  textBox.appendChild(line);

  const interval = setInterval(() => {
    line.textContent += text[i];
    i++;
    if (i >= text.length) {
      clearInterval(interval);
      line.classList.remove("cursor");
      typing = false;
      textBox.scrollTop = textBox.scrollHeight;
      if (callback) callback();
    }
  }, 30);
}

/* ===== 초기 텍스트 ===== */
typeText("아무것도 보이지 않는다.");
typeText("\n눈을 뜨고 있는지조차 확신할 수 없다.");

/* ===== 게임오버 ===== */
function triggerGameOver() {
  document.body.classList.add("shake");
  video.style.display = "block";
  video.currentTime = 0;
  video.play();
  input.disabled = true;
}

/* ===== 입력 처리 ===== */
input.addEventListener("keydown", e => {
  if (e.key !== "Enter" || typing) return;

  const cmd = input.value.trim();
  input.value = "";

  let response = "아무 일도 일어나지 않는다.";

  if (cmd.includes("눈")) {
    response = "눈을 떴지만 아무것도 보이지 않는다.";
  }
  else if (cmd.includes("깜빡")) {
    response = "아무 일도 일어나지 않는다.";
  }
  else if (cmd.includes("몸")) {
    response = "양손은 움직일 수 있는듯 하다.";
  }
  else if (cmd.includes("손")) {
    response = "손가락을 쥐었다 폈다.";
  }
  else if (cmd.includes("발")) {
    response = "무언가에 구속되어 있는 듯하다..";
  }
  else if (cmd.includes("숨") || cmd.includes("호흡")) {
    response = "숨을 들이마시고 내쉬었다.\n... 아무 일도 일어나지 않는다.";
  }
  else if (cmd.includes("심장")) {
    response = "심장이 뛰고 있다.";
  }
  else if (cmd.includes("소리") || cmd.includes("도움")) {
    typeText(
      "당신은 큰 소리로 도와주세요라고 외친다.\n" +
      "쿵쿵대는 소리와 함께 방문이 열린다.\n" +
      "\"그 입을 꼬매서 시끄러운 입으로 다신 못 말하게 해주지.\"",
      triggerGameOver
    );
    return;
  }
  else if (cmd.includes("기억")) {
    response = "머릿속이 흐릿하다.\n한 가지 단어가 떠오른다.\n베개..";
  }

  typeText("\n" + response);
});
</script>

</body>
</html>
