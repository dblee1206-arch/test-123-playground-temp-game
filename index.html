<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>TEXT RPG</title>
<style>
    body {
        margin: 0;
        background: black;
        color: white;
        font-family: monospace;
    }
    #game {
        padding: 20px;
        white-space: pre-wrap;
        line-height: 1.6;
    }
    .player {
        color: #aaa;
    }
    #inputBox {
        position: fixed;
        bottom: 0;
        width: 100%;
        background: black;
        border-top: 1px solid #333;
        padding: 10px;
    }
    input {
        width: 100%;
        background: black;
        color: white;
        border: none;
        outline: none;
        font-size: 16px;
    }
</style>
</head>
<body>

<div id="game"></div>

<div id="inputBox">
    <input id="input" placeholder="행동을 입력하세요..." autocomplete="off">
</div>

<script>
const game = document.getElementById("game");
const input = document.getElementById("input");

let isTyping = false;
let gameOver = false;

// 타자 효과
function typeText(text, callback) {
    isTyping = true;
    let i = 0;
    const interval = setInterval(() => {
        game.innerHTML += text[i];
        i++;
        if (i >= text.length) {
            clearInterval(interval);
            game.innerHTML += "\n\n";
            isTyping = false;
            if (callback) callback();
        }
        window.scrollTo(0, document.body.scrollHeight);
    }, 30);
}

// 초기 텍스트
const intro = [
    "아무것도 보이지 않는다.",
    "눈을 뜨고 있는지조차 확신할 수 없다."
];

function startIntro(i = 0) {
    if (i >= intro.length) return;
    typeText(intro[i], () => startIntro(i + 1));
}

startIntro();

// 행동 데이터
const actions = [
    {
        keys: ["눈을 뜬다"],
        result: "눈을 떴지만 아무것도 보이지 않는다."
    },
    {
        keys: ["눈을 깜빡인다"],
        result: "아무 일도 일어나지 않는다."
    },
    {
        keys: ["몸을 움직", "몸을 확인"],
        result: "양손은 움직일 수 있는듯 하다."
    },
    {
        keys: ["손을 움직"],
        result: "손가락을 쥐어다 핀다."
    },
    {
        keys: ["발을 움직"],
        result: "무언가에 구속되어 있는 듯하다.."
    },
    {
        keys: ["숨", "호흡"],
        result: "숨을 들이마시고 내쉬었다.\n... 아무 일도 일어나지 않는다."
    },
    {
        keys: ["심장"],
        result: "심장이 뛰고 있다."
    },
    {
        keys: ["귀", "소리"],
        result: "작게 흥얼거리는 휘파람 소리가 들린다."
    },
    {
        keys: ["냄새"],
        result: "아무 냄새도 나지 않는다."
    },
    {
        keys: ["기억"],
        result: "아직 머리 속이 흐릿해서 잘 기억이 나지 않는다..\n한 가지 단어가 떠오른다. 베개.."
    },
    {
        keys: ["소리친다", "도움"],
        result: () => {
            gameOver = true;
            return '당신은 큰 소리로 "도와주세요"라고 외친다.\n쿵쿵대는 소리와 함께 방문이 열린다.\n"그 입을 꼬매서 다신 못 떠들게 해주지." \n\nGAME OVER';
        }
    }
];

// 입력 처리
input.addEventListener("keydown", e => {
    if (e.key !== "Enter") return;
    if (isTyping || gameOver) return;

    const value = input.value.trim();
    if (!value) return;
    input.value = "";

    game.innerHTML += `<span class="player">> ${value}</span>\n`;

    let action = actions.find(a =>
        a.keys.some(k => value.includes(k))
    );

    if (!action) {
        typeText("아무 일도 일어나지 않는다.");
        return;
    }

    const result = typeof action.result === "function"
        ? action.result()
        : action.result;

    typeText(result);
});
</script>

</body>
</html>
