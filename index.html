import express from "express";
import fetch from "node-fetch";

const app = express();
app.use(express.json());
app.use(express.static("public"));

app.post("/chat", async (req, res) => {
  const userMessage = req.body.message;

  const r = await fetch("https://api.openai.com/v1/chat/completions", {
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "Authorization":`Bearer YOUR_API_KEY`
    },
    body:JSON.stringify({
      model:"gpt-4.1-mini",
      messages:[
        {role:"system", content:"너는 미스터리 게임의 NPC다. 분위기를 유지해라."},
        {role:"user", content:userMessage}
      ]
    })
  });

  const d = await r.json();
  res.json({reply:d.choices[0].message.content});
});

app.listen(3000);
